<html>
<header>
<title>ESP8266 lisp IDE</title>
</header>

<script>
function jsonp_pp(data) {
  var t = document.getElementById('pp');
  t.innerText = data;
}

function mkeditlink(f) {
  return "<a onclick=\"ide('pp?" + f + "');\" style='background:lightgrey; padding:0px;'>" + f + "</a>";
}

function jsonp_list(data) {
  var t = document.getElementById('list');
  t.innerHTML = data.split(/\n/).sort().map(function(f){ return f ? ("<span>" + mkeditlink(f) + "</span>") : ""; }).join("\n");;
}

function jsonp_eval(data) {
  var t = document.getElementById('eval');
  t.innerText = data;
}

function update(url) {
  var s = document.createElement('script');
  s.src = url;
  document.head.appendChild(s);
  s.onload = function() { s.remove(); };
  s.onerror = function() { s.remove(); console.log("FAIL: " + url); };
}
</script>

<body>

<style>
.term {
  //word-wrap: break-word;
  display: inline-block;
  border: 2px solid black;
  padding: 5px;
  border-radius: 5px;
  //background: black;
  //color: #8AFF4F;
  background: yellow;
  font-weight: bold;
}
</style>

<h1>ESP8266 lisp IDE</h1>

<h2>List of user defined functions</h2>
<div id='list'>
</div>
<br><button onclick='ide("list");'>list</button><br>

<h2>One function</h2>
<pre id='pp' class='term' contentEditable='true'>
Data here...
</pre>
<br><button onclick='ide("pp?fibo");'>load</button><br>

<h2>Eval</h2>
<input id='einput'>
<pre id='eval' class='term'>
Data here...
</pre>
<br><button onclick='ide("eval?" + document.getElementById("einput").value);'>eval</button><br>

<script>
function ide(path) {
  update("http://localhost:8080/ide/" + path + "??" + (new Date()).valueOf());
}
</script>

</body>
</html>
